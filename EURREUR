# VERSION SIMPLIFIÉE - DIRECTEMENT DANS VOTRE CODE
        dir.create(dirname(jsonPath), recursive = TRUE, showWarnings = FALSE)
        
        jsonlite::write_json(runParams, jsonPath, auto_unbox = TRUE, pretty = TRUE)
        runParams[c("inputSelected", "scopeSelected")] <- NULL
        
        # NETTOYAGE SPÉCIFIQUE POUR DATABRICKS
        # Convertir tous les vecteurs en strings avec virgules
        for(param_name in names(runParams)) {
          param_value <- runParams[[param_name]]
          if(!is.null(param_value) && length(param_value) > 0) {
            if(is.character(param_value) && length(param_value) > 1) {
              runParams[[param_name]] <- paste(param_value, collapse = ",")
            } else if(is.logical(param_value)) {
              runParams[[param_name]] <- tolower(as.character(param_value))
            } else if(!is.character(param_value)) {
              runParams[[param_name]] <- as.character(param_value)
            }
          }
        }
        
        print("inputSelected")
        print(runParams)
        runId <- call_api_job(
            url = paste0(Sys.getenv("databricks_host"), Sys.getenv("urlRunJob")),
            databricks_token = Sys.getenv("databricks_token"),
            job_id = runParams$jobSelected,
            params = runParams,
            type = "job"
        )
