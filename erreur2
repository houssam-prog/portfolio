environment = dbutils.widgets.get("environment")
region = dbutils.widgets.get("region")
type_of_business = dbutils.widgets.get("type_of_business")
year = dbutils.widgets.get("year")
query =(f"""
  SELECT * FROM fndt.pv_ip_budget_investment_capacity_output_fndt_{environment}
  WHERE region = '{region}'
  AND type_of_business = '{type_of_business}'
  AND year = '{year}'
""")

df = spark.sql(query).toPandas()
display(df)
